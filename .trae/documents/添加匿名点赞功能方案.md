## 添加匿名点赞功能方案

### 1. 数据库结构修改

**修改`post_likes`表**：
- 将`user_id`字段改为可空
- 添加`anonymous_id`字段，用于识别匿名用户
- 更新唯一约束，确保同一个用户或同一个匿名用户只能点赞一次

**修改`likes`表**（评论点赞，可选）：
- 同样支持匿名点赞

### 2. 后端API修改

**修改文章点赞API**：
- 移除`verifyToken`中间件
- 支持匿名点赞，生成唯一的`anonymous_id`
- 保存`anonymous_id`到localStorage
- 更新`post_stats`表中的点赞数

**修改评论点赞API**（可选）：
- 同样支持匿名点赞

### 3. 前端代码修改

**添加匿名点赞功能**：
- 生成并保存`anonymous_id`到localStorage
- 修改点赞按钮点击事件，支持匿名点赞
- 更新点赞状态显示

### 4. 实现步骤

1. **更新数据库表结构**
2. 修改后端API代码
3. 修改前端代码
4. 测试点赞功能

### 预期结果

- ✅ 用户无需登录即可点赞
- ✅ 点赞信息持久化到数据库
- ✅ 同一个用户/匿名用户只能点赞一次
- ✅ 点赞数实时更新
- ✅ 不影响现有登录用户的点赞功能

### 技术说明

**匿名用户识别**：
- 为匿名用户生成唯一的`anonymous_id`
- 使用`crypto.randomUUID()`生成唯一ID
- 将`anonymous_id`保存到localStorage
- 用于防止同一用户重复点赞

**数据库设计**：
- `user_id`和`anonymous_id`字段至少有一个有值
- 唯一约束：`(user_id, post_id)` 和 `(anonymous_id, post_id)`

**API设计**：
- 支持同时处理登录用户和匿名用户
- 根据请求头中的JWT令牌或请求体中的`anonymous_id`确定用户身份

这个方案将允许用户无需登录即可点赞，同时保持点赞的唯一性和持久化存储。